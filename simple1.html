<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <title>„Éü„Éã„Ç≤„Éº„É†</title>
    <!-- „Éì„É•„Éº„Éù„Éº„Éà„ÅÆË®≠ÂÆö -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <style>
        body {
            margin: 0;
            overflow: hidden;
            background-color: #f0f8ff;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
        }

        #gameArea {
            position: relative;
            width: 360px;
            height: 640px;
            background-color: #add8e6;
            overflow: hidden;
        }

        #player {
            position: absolute;
            bottom: 10px;
            left: calc(50% - 25px);
            font-size: 50px;
        }

        .obstacle,
        .item {
            position: absolute;
            top: 0;
            font-size: 40px;
        }

        #scoreboard {
            position: absolute;
            top: 10px;
            left: 10px;
            font-size: 24px;
            color: #000;
        }

        #gameOver {
            position: absolute;
            top: 40%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 36px;
            color: #ff0000;
            display: none;
            text-align: center;
        }

        #restartButton {
            margin-top: 20px;
            padding: 10px 20px;
            font-size: 24px;
        }
    </style>
</head>

<body>
    <div id="gameArea">
        <div id="scoreboard">„Çπ„Ç≥„Ç¢: 0</div>
        <div id="player">üê±</div>
        <div id="gameOver">
            <div id="gameOverText">„Ç≤„Éº„É†„Ç™„Éº„Éê„Éº</div>
            <div id="finalScore"></div>
            <button id="restartButton">ÂÜç„Çπ„Çø„Éº„Éà</button>
        </div>
    </div>
    <script>
        let player = document.getElementById('player');
        let gameArea = document.getElementById('gameArea');
        let scoreboard = document.getElementById('scoreboard');
        let gameOverScreen = document.getElementById('gameOver');
        let restartButton = document.getElementById('restartButton');
        let finalScore = document.getElementById('finalScore');

        let playerX = gameArea.offsetWidth / 2 - player.offsetWidth / 2;
        let score = 0;
        let gameInterval;
        let obstacleInterval;
        let itemInterval;
        let gameTime = 60; // 60 seconds
        let keysPressed = {};

        function startGame() {
            gameOverScreen.style.display = 'none';
            score = 0;
            scoreboard.textContent = '„Çπ„Ç≥„Ç¢: ' + score;
            playerX = gameArea.offsetWidth / 2 - player.offsetWidth / 2;
            player.style.left = playerX + 'px';

            gameInterval = setInterval(gameLoop, 20);
            obstacleInterval = setInterval(createObstacle, 1000);
            itemInterval = setInterval(createItem, 3000);

            setTimeout(endGame, gameTime * 1000);
        }

        function endGame() {
            clearInterval(gameInterval);
            clearInterval(obstacleInterval);
            clearInterval(itemInterval);
            gameOverScreen.style.display = 'block';
            finalScore.textContent = '„ÅÇ„Å™„Åü„ÅÆ„Çπ„Ç≥„Ç¢: ' + score;
        }

        function gameLoop() {
            // „Ç≠„Éº„Éú„Éº„ÉâÊìç‰Ωú„Å´„Çà„ÇãÁßªÂãï
            if (keysPressed['ArrowLeft']) {
                playerX -= 5;
                if (playerX < 0) playerX = 0;
                player.style.left = playerX + 'px';
            }
            if (keysPressed['ArrowRight']) {
                playerX += 5;
                if (playerX > gameArea.offsetWidth - player.offsetWidth) playerX = gameArea.offsetWidth - player.offsetWidth;
                player.style.left = playerX + 'px';
            }

            let obstacles = document.getElementsByClassName('obstacle');
            for (let i = 0; i < obstacles.length; i++) {
                let obstacle = obstacles[i];
                let obstacleY = parseFloat(obstacle.style.top);
                obstacleY += 5;
                obstacle.style.top = obstacleY + 'px';

                if (obstacleY > gameArea.offsetHeight) {
                    obstacle.remove();
                } else {
                    if (checkCollision(player, obstacle)) {
                        gameOver();
                    }
                }
            }

            let items = document.getElementsByClassName('item');
            for (let i = 0; i < items.length; i++) {
                let item = items[i];
                let itemY = parseFloat(item.style.top);
                itemY += 3;
                item.style.top = itemY + 'px';

                if (itemY > gameArea.offsetHeight) {
                    item.remove();
                } else {
                    if (checkCollision(player, item)) {
                        item.remove();
                        score += 10;
                        scoreboard.textContent = '„Çπ„Ç≥„Ç¢: ' + score;
                    }
                }
            }
        }

        function createObstacle() {
            let obstacle = document.createElement('div');
            obstacle.classList.add('obstacle');
            obstacle.textContent = '‚öΩ';
            obstacle.style.left = Math.random() * (gameArea.offsetWidth - 40) + 'px';
            obstacle.style.top = '0px';
            gameArea.appendChild(obstacle);
        }

        function createItem() {
            let item = document.createElement('div');
            item.classList.add('item');
            item.textContent = 'üçé';
            item.style.left = Math.random() * (gameArea.offsetWidth - 40) + 'px';
            item.style.top = '0px';
            gameArea.appendChild(item);
        }

        function checkCollision(a, b) {
            let aRect = a.getBoundingClientRect();
            let bRect = b.getBoundingClientRect();

            return !(
                aRect.top > bRect.bottom ||
                aRect.bottom < bRect.top ||
                aRect.left > bRect.right ||
                aRect.right < bRect.left
            );
        }

        function gameOver() {
            endGame();
        }

        // „Çø„ÉÉ„ÉÅÊìç‰Ωú
        gameArea.addEventListener('touchmove', function (e) {
            let touch = e.touches[0];
            let rect = gameArea.getBoundingClientRect();
            playerX = touch.clientX - rect.left - player.offsetWidth / 2;
            if (playerX < 0) playerX = 0;
            if (playerX > gameArea.offsetWidth - player.offsetWidth) playerX = gameArea.offsetWidth - player.offsetWidth;
            player.style.left = playerX + 'px';
            e.preventDefault();
        });

        // „Ç≠„Éº„Éú„Éº„ÉâÊìç‰Ωú
        document.addEventListener('keydown', function (e) {
            keysPressed[e.key] = true;
        });

        document.addEventListener('keyup', function (e) {
            keysPressed[e.key] = false;
        });

        restartButton.addEventListener('click', function () {
            gameOverScreen.style.display = 'none';
            // ÈöúÂÆ≥Áâ©„Å®„Ç¢„Ç§„ÉÜ„É†„ÇíÂâäÈô§
            let obstacles = document.getElementsByClassName('obstacle');
            while (obstacles[0]) {
                obstacles[0].parentNode.removeChild(obstacles[0]);
            }
            let items = document.getElementsByClassName('item');
            while (items[0]) {
                items[0].parentNode.removeChild(items[0]);
            }
            keysPressed = {}; // „Ç≠„ÉºÊäº‰∏ãÁä∂ÊÖã„ÅÆ„É™„Çª„ÉÉ„Éà
            startGame();
        });

        // „Ç≤„Éº„É†ÈñãÂßã
        startGame();
    </script>
</body>

</html>